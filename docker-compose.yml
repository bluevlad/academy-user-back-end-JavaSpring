version: '3.8'

services:
  academy-service:
    build: .
    container_name: academy-user-back-end-JavaSpring
    ports:
      - "9002:8080"
    environment:
      - SERVER_PORT=8080
      # Docker 내부에서 호스트의 DB에 접근하기 위해 host.docker.internal 사용
      # MySQL 8.0 이상 접속 시 allowPublicKeyRetrieval=true 필요할 수 있음
      - DB_URL=${DB_URL:-jdbc:mysql://172.30.1.78:3306/acm_basic?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Seoul}
      - DB_USERNAME=${DB_USERNAME:-root}
      - DB_PASSWORD=${DB_PASSWORD:-password}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always
